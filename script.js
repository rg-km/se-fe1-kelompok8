const CELL_SIZE=20,CANVAS_SIZE=500,REDRAW_INTERVAL=50,WIDTH=25,HEIGHT=25,DIRECTION={LEFT:0,RIGHT:1,UP:2,DOWN:3};var MOVE_INTERVAL=200,wallX=[],wallY=[],wall2=[{x1:5,x2:20,y:5}],wall3=[{x1:5,x2:20,y:10}],wall4=[{x1:5,x2:20,y:15}],wall5=[{x:5,y1:5,y2:20},{x:19,y1:7,y2:20}];function initPosition(){return{x:Math.floor(25*Math.random()),y:Math.floor(25*Math.random())}}function initHeadAndBody(){let e=initPosition();return{head:e,body:[{x:e.x,y:e.y}]}}function initDirection(){return Math.floor(4*Math.random())}function initSnake(e){return{color:e,...initHeadAndBody(),direction:initDirection(),score:0,scoreReset:0,level:0,lifes:0}}var sum=0,life=[{x:sum,y:0},{x:sum+20,y:0},{x:sum+40,y:0}];let lifes={color:"green",position:initPosition(),visible:!0,visibleCount:0},snake1=initSnake(""),apple={color:"red",position:initPosition()},apple1={color:"green",position:initPosition()};function drawCell(e,l,i,t){e.fillStyle=t,e.fillRect(20*l,20*i,20,20)}function drawScore(e){let l;e.color==snake1.color&&(l=document.getElementById("score1Board"));let i=l.getContext("2d");i.clearRect(0,0,500,500),i.font="30px Arial",i.fillStyle=e.color,i.fillText(e.score,10,l.scrollHeight/2)}function isPrime(e){let l=0;for(let i=1;i<=e;i++)e%i==0&&l++;return 2==l}function drawLife(e){if(lifes.visible){let l=document.getElementById("nyawa");e.drawImage(l,20*lifes.position.x,20*lifes.position.y,20,20),lifes.visibleCount++,10==lifes.visibleCount&&(lifes.visible=!1)}else drawCell(e,lifes.position.x,lifes.position.y,"rgb(255,255,255,0)"),lifes.visibleCount--,0==lifes.visibleCount&&(lifes.visible=!0)}function initWall2(){for(let e=0;e<wall2.length;e++)for(let l=wall2[e].x1;l<=wall2[e].x2;l++)wallX.push(l),wallY.push(wall2[e].y)}function initWall3(){for(let e=0;e<wall3.length;e++)for(let l=wall3[e].x1;l<=wall3[e].x2;l++)wallX.push(l),wallY.push(wall3[e].y)}function initWall4(){for(let e=0;e<wall4.length;e++)for(let l=wall4[e].x1;l<=wall4[e].x2;l++)wallX.push(l),wallY.push(wall4[e].y)}function initWall5(){for(let e=0;e<wall5.length;e++)for(let l=wall5[e].y1;l<=wall5[e].y2;l++)wallY.push(l),wallX.push(wall5[e].x)}function createWall(){let e=document.getElementById("snakeBoard").getContext("2d");imgTrap=new Image;for(var l=0;l<wallX.length;)imgTrap.src="assets/bush2.png",e.drawImage(imgTrap,20*wallX[l],20*wallY[l],20,20),l++}function drawSnake(e,l){e.fillStyle="yellow";let i=document.getElementById("head"),t=document.getElementById("body");drawCell(e,l.head.x,l.head.y),e.drawImage(i,20*l.head.x,20*l.head.y,20,20);for(let i=1;i<l.body.length;i++)drawCell(e,l.body[i].x,l.body[i].y),e.drawImage(t,20*l.body[i].x,20*l.body[i].y,20,20)}function draw(){setInterval((function(){let e=document.getElementById("snakeBoard").getContext("2d");e.clearRect(0,0,500,500),drawSnake(e,snake1);let l=document.getElementById("apple");e.drawImage(l,20*apple.position.x,20*apple.position.y,20,20),e.drawImage(l,20*apple1.position.x,20*apple1.position.y,20,20),isPrime(snake1.score)&&drawLife(e),createWall(),document.getElementById("level").innerHTML="Level: "+snake1.level,document.getElementById("score").innerHTML="Score",drawScore(snake1),document.getElementById("speed").innerHTML="Speed "+MOVE_INTERVAL+" ms";for(var i=0;i<=life.length;i++){let l=document.getElementById("nyawa");e.drawImage(l,life[i].x,life[i].y,20,20)}}),50)}function teleport(e){e.head.x<0&&(e.head.x=24),e.head.x>=25&&(e.head.x=0),e.head.y<0&&(e.head.y=24),e.head.y>=25&&(e.head.y=0)}function eat(e,l,i){if(e.head.x==l.position.x&&e.head.y==l.position.y&&(l.position=initPosition(),e.score++,e.scoreReset++,e.body.push({x:e.head.x,y:e.head.y})),e.head.x==i.position.x&&e.head.y==i.position.y&&(i.position=initPosition(),e.score++,e.scoreReset++,e.body.push({x:e.head.x,y:e.head.y})),e.head.x==lifes.position.x&&e.head.y==lifes.position.y&&isPrime(e.score)){lifes.position=initPosition(),e.lifes++;for(var t=0;t<e.lifes;t++)1===e.lifes&&(life.push({x:sum+60,y:0}),sum+=20);e.lifes=0}for(;5===e.scoreReset;){if(e.level<=4)0==e.level?initWall2():1==e.level?initWall3():2==e.level?initWall4():3==e.level&&(wallX=[],wallY=[],initWall5()),e.level++,MOVE_INTERVAL-=20,alert("Level Up"+e.level),document.getElementById("levelUp").play();e.scoreReset=0}}function moveLeft(e){e.head.x--,teleport(e),eat(e,apple,apple1)}function moveRight(e){e.head.x++,teleport(e),eat(e,apple,apple1)}function moveDown(e){e.head.y++,teleport(e),eat(e,apple,apple1)}function moveUp(e){e.head.y--,teleport(e),eat(e,apple,apple1)}function checkCollision(e){let l=!1;for(let i=0;i<e.length;i++)for(let t=0;t<e.length;t++)for(let o=1;o<e[t].body.length;o++)e[i].head.x==e[t].body[o].x&&e[i].head.y==e[t].body[o].y&&(l=!0,life.length--,sum-=20);for(let e=0;e<wallX.length;e++)snake1.head.x!==wallX[e]||2!=snake1.direction&&3!=snake1.direction||snake1.head.y!==wallY[e]&&snake1.head.y!==wallY[e]||(life.length--,sum-=20,0==life.length&&(l=!0)),snake1.head.y!==wallY[e]||0!=snake1.direction&&1!=snake1.direction||snake1.head.x!==wallX[e]&&snake1.head.x!==wallX[e]||(life.length--,sum-=20,0==life.length&&(l=!0));for(let e=0;e<wallX.length;e++)apple.position.x===wallX[e]&&(apple.position.y!==wallY[e]&&apple.position.y!==wallY[e]||(apple.position=initPosition())),apple1.position.y===wallY[e]&&(apple1.position.x!==wallX[e]&&apple1.position.x!==wallX[e]||(apple1.position=initPosition())),lifes.position.y===wallY[e]&&(lifes.position.x!==wallX[e]&&lifes.position.x!==wallX[e]||(lifes.position=initPosition()));if(l&&0===life.length){document.getElementById("gameOver").play(),setTimeout((()=>{alert("Game Over"),location.reload()}),150),MOVE_INTERVAL=150,snake1=initSnake("purple")}return l}function move(e){switch(e.direction){case DIRECTION.LEFT:moveLeft(e);break;case DIRECTION.RIGHT:moveRight(e);break;case DIRECTION.DOWN:moveDown(e);break;case DIRECTION.UP:moveUp(e)}moveBody(e),checkCollision([snake1])?initGame():setTimeout((function(){move(e)}),MOVE_INTERVAL)}function moveBody(e){e.body.unshift({x:e.head.x,y:e.head.y}),e.body.pop()}function turn(e,l){l!=={[DIRECTION.LEFT]:DIRECTION.RIGHT,[DIRECTION.RIGHT]:DIRECTION.LEFT,[DIRECTION.DOWN]:DIRECTION.UP,[DIRECTION.UP]:DIRECTION.DOWN}[e.direction]&&(e.direction=l)}function initGame(){move(snake1)}document.addEventListener("keydown",(function(e){"ArrowLeft"===e.key?turn(snake1,DIRECTION.LEFT):"ArrowRight"===e.key?turn(snake1,DIRECTION.RIGHT):"ArrowUp"===e.key?turn(snake1,DIRECTION.UP):"ArrowDown"===e.key&&turn(snake1,DIRECTION.DOWN)})),initGame();
